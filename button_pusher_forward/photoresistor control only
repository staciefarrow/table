#include <Servo.h>

Servo servoup;
Servo servodown;

int right = A7;
int left = A6;
int r = 0;
int l = 0;
int i = 0;
int sum_r = 0;
int sum_l = 0;
int normal_r = 0;
int normal_l = 0;
int command = 0;
int servopin_up = 10;
int servopin_down = 9;
int off_pos_up = 180; //angle when idle
int off_pos_down = 0;
int on_pos_up = 0; //angle when pushing button
int on_pos_down = 180;

void setup() {
  pinMode(right, INPUT);
  pinMode(left, INPUT);
  servoup.attach(servopin_up);
  servoup.write(off_pos_up);
  servodown.attach(servopin_down);
  servodown.write(off_pos_down);
  Serial.begin(9600);

}

void loop() {
  while (millis() < 3000) {
    i += 1;
    sum_r = sum_r + analogRead(right);
    sum_l = sum_l + analogRead(left);
    delay(100);
    if (millis() > 3000) {
      normal_r = sum_r / i;
      normal_l = sum_l / i;
      Serial.print(normal_r);
      Serial.print(normal_l);
      delay(2000);
    }
  }

  if ((analogRead(right) * 1.3) < normal_r) {
    Serial.print("up");
    Serial.println(analogRead(right));
    if (command != 1){
      command = 1;
      servodown.write(off_pos_down);
      delay(1000);
      servoup.write(on_pos_up);
    }
  }
  else if ((analogRead(left) * 1.3) < normal_l) {
    Serial.print("down");
    Serial.println(analogRead(left));
    if (command != -1){
      command = -1;
      servoup.write(off_pos_up);
      delay(1000);
      servodown.write(on_pos_down);
    }
  }
  else if (command != 0){
    command = 0;
    servoup.write(off_pos_up);
    servodown.write(off_pos_down);
    delay(1000);
  }

Serial.print(command);

//  Serial.print("right");
//  r = analogRead(right);
//  Serial.println(r);
//  Serial.print("left");
//  l = analogRead(left);
//  Serial.print(l);
//  delay(2000);


}
